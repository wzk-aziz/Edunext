<div class="mentorship-programs-container">
  <!-- Replace the current mentorship-header with this enhanced version -->
  <div class="mentorship-header">
    <div class="header-content">
      <h1>My Mentorship Programs</h1>

      
      <button class="pdf-download-btn" (click)="downloadProgramsAsPDF()">
        <i class="fas fa-file-pdf"></i> Export Programs to PDF
      </button>
    </div>
    
    <div class="stats-container">
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-graduation-cap"></i></div>
        <div class="stat-value">{{ filteredPrograms.length }}</div>
        <div class="stat-label">Total Programs</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-users"></i></div>
        <div class="stat-value">{{ getTotalStudents() }}</div>
        <div class="stat-label">Enrolled Students</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-icon"><i class="fas fa-dollar-sign"></i></div>
        <div class="stat-value">{{ getAveragePrice() | currency }}</div>
        <div class="stat-label">Avg. Price</div>
      </div>
    </div>
  </div>

  <!-- Status Message -->
  <div *ngIf="statusMessage" class="status-message" [ngClass]="statusMessage.type">
    <i class="fas" [ngClass]="statusMessage.type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'"></i>
    <span>{{ statusMessage.text }}</span>
    <button class="close-message" (click)="statusMessage = null">
      <i class="fas fa-times"></i>
    </button>
  </div>

  <!-- Create New Program Button -->
  <div class="action-bar">
    <button class="create-btn" (click)="openCreateModal()">
      <i class="fas fa-plus"></i> Create New Program
    </button>
  </div>

  <!-- Filters and Search -->
  <div class="filters-section">
    <h3 class="filters-heading">
      <i class="fas fa-filter"></i> Filter Programs
      <span class="filter-count" *ngIf="filteredPrograms.length > 0">{{ filteredPrograms.length }} programs</span>
    </h3>
    
    <div class="filters-container">
      <div class="search-box">
        <i class="fas fa-search"></i>
        <input 
          type="text" 
          [(ngModel)]="searchTerm" 
          (input)="onSearchChange()" 
          placeholder="Search programs...">
      </div>
      
      <!-- Subject Filter -->
      <div class="filter-dropdown">
        <label for="subject-filter">Subject:</label>
        <select id="subject-filter" [(ngModel)]="selectedSubject" (change)="onSubjectChange()">
          <option value="all">All Subjects</option>
          <option *ngFor="let subject of subjects" [value]="subject">{{ subject }}</option>
        </select>
      </div>
      
      <!-- Clear Filters Button -->
      <button class="clear-filters-btn" 
        (click)="searchTerm = ''; selectedSubject = 'all'; filterPrograms()">
        <i class="fas fa-times"></i> Clear All
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div class="loading-container" *ngIf="loading">
    <div class="spinner"></div>
    <p>Loading your mentorship programs...</p>
  </div>

  <!-- Error State -->
  <div class="error-container" *ngIf="error">
    <div class="error-icon">
      <i class="fas fa-exclamation-triangle"></i>
    </div>
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadMentorshipPrograms()">Try Again</button>
  </div>

  <!-- No Results -->
  <div class="no-results" *ngIf="!loading && !error && filteredPrograms.length === 0">
    <div class="empty-icon">
      <i class="fas fa-graduation-cap"></i>
    </div>
    <p>You don't have any mentorship programs yet.</p>
    <button class="create-btn" (click)="openCreateModal()">Create Your First Program</button>
  </div>

  <!-- Sorting Options -->  
  <div class="sorting-section" *ngIf="!loading && !error && filteredPrograms.length > 0">
    <div class="sorting-controls">
      <label for="sort-price">Sort by Price:</label>
      <select id="sort-price" [(ngModel)]="sortByPrice" (change)="onSortChange()">
        <option value="none">Default Order</option>
        <option value="asc">Lowest to Highest</option>
        <option value="desc">Highest to Lowest</option>
      </select>
    </div>
  </div>

  <!-- Programs Grid -->
<!-- Programs List -->
<div class="programs-list" *ngIf="!loading && !error && filteredPrograms.length > 0">
  <!-- Replace the program-item with this enhanced version -->
  <div class="program-item" *ngFor="let program of filteredPrograms">
    <div class="program-header">
      <div class="program-title-section">
        <span class="program-badge" [attr.data-subject]="program.programSubject">
          {{ program.programSubject }}
        </span>
        <h3 class="program-title">{{ program.programName }}</h3>
      </div>
      <div class="program-price">
        <span>{{ program.programPrice | currency }}</span>
      </div>
    </div>
    
    <div class="program-content">
      <div class="program-info">
        <div class="program-meta">
          <div class="detail-item">
            <i class="far fa-calendar-alt"></i>
            <span>{{ formatDate(program.programStartDate) }} - {{ formatDate(program.programEndDate) }}</span>
          </div>
          
          <div class="detail-item">
            <i class="fas fa-user-tie"></i>
            <span>Instructor: {{ currentInstructorName }}</span>
          </div>
          
          <!-- Program status indicator -->
          <div class="program-status" [ngClass]="getProgramStatus(program)">
            <i class="fas" [ngClass]="getProgramStatusIcon(program)"></i>
            <span>{{ getProgramStatusText(program) }}</span>
          </div>
        </div>
        
        <p class="program-description">{{ program.programDescription }}</p>
        
        <!-- Progress bars -->
        <div class="program-progress">
          <div class="progress-item">
            <div class="progress-label">
              <span>Duration Progress</span>
              <span>{{ getDurationProgress(program) }}%</span>
            </div>
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="getDurationProgress(program)"></div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="program-actions">

        <button class="edit-btn" (click)="openEditModal(program)">
          <i class="fas fa-edit"></i> Edit
        </button>
        <button class="delete-btn" (click)="openDeleteConfirmation(program)">
          <i class="fas fa-trash"></i> Delete
        </button>
      </div>
    </div>
  </div>
</div>



</div>

<!-- Program Modal (Create/Edit) -->
<div class="program-modal-overlay" *ngIf="showProgramModal">
  <div class="program-modal">
    <div class="program-modal-header">
      <h2>{{ isEditing ? 'Edit Program' : 'Create New Program' }}</h2>
      <button class="close-btn" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <!-- Replace the program-modal-content div with this improved version -->
    
    <div class="program-modal-content">
      <form [formGroup]="programForm" (ngSubmit)="saveProgram()">
        <!-- Program Name -->
        <div class="form-group">
          <label for="program-name">
            Program Name <span class="required-field">*</span>
          </label>
          <input 
            id="program-name"
            type="text"
            formControlName="programName"
            class="form-control"
            [class.is-invalid]="nameControl?.invalid && (nameControl?.dirty || nameControl?.touched)"
            placeholder="Enter program name">
          
          <div class="validation-error" *ngIf="nameControl?.invalid && (nameControl?.dirty || nameControl?.touched)">
            <span *ngIf="nameControl?.errors?.['required']">Program name is required</span>
          </div>
        </div>
        
        <!-- Subject -->
        <div class="form-group">
          <label for="program-subject">
            Subject <span class="required-field">*</span>
          </label>
          <select
            id="program-subject"
            formControlName="programSubject"
            class="form-control"
            [class.is-invalid]="subjectControl?.invalid && (subjectControl?.dirty || subjectControl?.touched)">
            <option value="" disabled>Select a subject</option>
            <option value="Mathematics">Mathematics</option>
            <option value="Physics">Physics</option>
            <option value="Chemistry">Chemistry</option>
            <option value="Biology">Biology</option>
            <option value="Computer Science">Computer Science</option>
            <option value="Programming">Programming</option>
            <option value="Language Arts">Language Arts</option>
            <option value="Foreign Languages">Foreign Languages</option>
            <option value="Other">Other</option>
          </select>
          
          <div class="validation-error" *ngIf="subjectControl?.invalid && (subjectControl?.dirty || subjectControl?.touched)">
            <span *ngIf="subjectControl?.errors?.['required']">Subject is required</span>
          </div>
        </div>
        
        <!-- Description -->
        <div class="form-group">
          <label for="program-description">
            Description <span class="required-field">*</span>
          </label>
          <textarea 
            id="program-description"
            formControlName="programDescription"
            class="form-control"
            rows="4"
            placeholder="Describe what students will learn in this program..."
            [class.is-invalid]="descriptionControl?.invalid && (descriptionControl?.dirty || descriptionControl?.touched)"></textarea>
          
          <div class="validation-error" *ngIf="descriptionControl?.invalid && (descriptionControl?.dirty || descriptionControl?.touched)">
            <span *ngIf="descriptionControl?.errors?.['required']">Description is required</span>
            <span *ngIf="descriptionControl?.errors?.['minlength']">Description must be at least 20 characters</span>
          </div>
          <div class="form-hint" *ngIf="descriptionControl?.value">
            <span [class.text-danger]="descriptionControl?.value.length < 20">
              {{ descriptionControl?.value.length }} / 20 characters minimum
            </span>
          </div>
        </div>
        
        <div class="form-row">
          <!-- Price -->
          <div class="form-group">
            <label for="program-price">
              Price ($) <span class="required-field">*</span>
            </label>
            <div class="price-input">
              <span class="currency-symbol">$</span>
              <input 
                id="program-price"
                type="number"
                formControlName="programPrice"
                class="form-control"
                min="0"
                step="0.01"
                placeholder="0.00"
                [class.is-invalid]="priceControl?.invalid && (priceControl?.dirty || priceControl?.touched)">
            </div>
            
            <div class="validation-error" *ngIf="priceControl?.invalid && (priceControl?.dirty || priceControl?.touched)">
              <span *ngIf="priceControl?.errors?.['required']">Price is required</span>
              <span *ngIf="priceControl?.errors?.['min']">Price cannot be negative</span>
            </div>
          </div>
        </div>
        
        <div class="form-row date-row">
          <!-- Start Date -->
          <div class="form-group">
            <label for="program-start-date">
              Start Date <span class="required-field">*</span>
            </label>
            <div class="date-input-container">
              <i class="far fa-calendar-alt calendar-icon"></i>
              <input 
                id="program-start-date"
                type="date"
                formControlName="programStartDate"
                class="form-control"
                [class.is-invalid]="startDateControl?.invalid && (startDateControl?.dirty || startDateControl?.touched)">
            </div>
            
            <div class="validation-error" *ngIf="startDateControl?.invalid && (startDateControl?.dirty || startDateControl?.touched)">
              <span *ngIf="startDateControl?.errors?.['required']">Start date is required</span>
            </div>
          </div>
          
          <!-- End Date -->
          <div class="form-group">
            <label for="program-end-date">
              End Date <span class="required-field">*</span>
            </label>
            <div class="date-input-container">
              <i class="far fa-calendar-alt calendar-icon"></i>
              <input 
                id="program-end-date"
                type="date"
                formControlName="programEndDate"
                class="form-control"
                [class.is-invalid]="endDateControl?.invalid && (endDateControl?.dirty || endDateControl?.touched)">
            </div>
            
            <div class="validation-error" *ngIf="endDateControl?.invalid && (endDateControl?.dirty || endDateControl?.touched)">
              <span *ngIf="endDateControl?.errors?.['required']">End date is required</span>
            </div>
          </div>
        </div>
        
        <div class="form-actions">
          <button type="button" class="cancel-btn" (click)="closeModal()">Cancel</button>
          <button type="submit" class="save-btn" [disabled]="programForm.invalid">
            {{ isEditing ? 'Update Program' : 'Create Program' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="delete-modal-overlay" *ngIf="showDeleteConfirmation">
  <div class="delete-modal">
    <div class="delete-modal-header">
      <h2>Delete Program</h2>
      <button class="close-btn" (click)="closeDeleteConfirmation()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="delete-modal-content">
      <i class="fas fa-exclamation-triangle warning-icon"></i>
      <p class="delete-warning">Are you sure you want to delete this program?</p>
      <p class="program-name">{{ programToDelete?.programName }}</p>
      <p class="delete-message">This action cannot be undone.</p>
      
      <div class="delete-actions">
        <button class="cancel-btn" (click)="closeDeleteConfirmation()">Cancel</button>
        <button class="confirm-delete-btn" (click)="confirmDelete()">Yes, Delete</button>
      </div>
    </div>
  </div>
