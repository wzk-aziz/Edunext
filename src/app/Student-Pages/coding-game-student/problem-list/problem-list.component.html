<div class="container-fluid py-4">
  <div class="row justify-content-center">
    <div class="col-12 col-xxl-10">
      <div class="card shadow border-0 rounded-lg">
        <div class="card-header bg-gradient-primary text-white py-3">
          <h2 class="mb-0 text-center fw-bold">Catalogue de Problèmes</h2>
        </div>
        
        <div class="card-body px-4 py-4">
          <!-- Filter section with improved styling -->
          <div class="row mb-4 align-items-center">
            <div class="col-md-7">
              <div class="d-flex flex-wrap align-items-center gap-2">
                <label class="me-2 text-primary fw-bold">Filtrer par difficulté:</label>
                <div class="btn-group shadow-sm">
                  <button 
                    *ngFor="let difficulty of difficulties" 
                    class="btn btn-sm px-3 py-2" 
                    [class.btn-primary]="selectedDifficulty === difficulty"
                    [class.btn-outline-primary]="selectedDifficulty !== difficulty"
                    (click)="onDifficultyChange(difficulty)">
                    <i class="fas" 
                      [ngClass]="{
                        'fa-smile': difficulty === 'Easy',
                        'fa-meh': difficulty === 'Medium',
                        'fa-frown': difficulty === 'Hard'
                      }"></i>
                    {{ difficulty }}
                  </button>
                </div>
                <button class="btn btn-sm btn-outline-secondary ms-2" (click)="resetFilters()" *ngIf="selectedDifficulty">
                  <i class="fas fa-times"></i> Effacer
                </button>
              </div>
            </div>
            <div class="col-md-5 text-md-end mt-3 mt-md-0">
              <span class="badge bg-light text-dark rounded-pill px-3 py-2">
                <i class="fas fa-list me-1"></i>
                {{ filteredProblems.length }} problème(s) 
                <span *ngIf="selectedDifficulty" class="ms-1 fst-italic">(filtrés par {{ selectedDifficulty }})</span>
              </span>
            </div>
          </div>

          <!-- Table of problems with improved styling -->
          <div class="table-responsive">
            <table class="table table-hover align-middle custom-table">
              <thead>
                <tr class="bg-light">
                  <th class="text-primary fw-bold border-0">Titre</th>
                  <th class="text-primary fw-bold border-0">Description</th>
                  <th class="text-primary fw-bold border-0 text-center">Difficulté</th>
                  <th class="text-primary fw-bold border-0 text-center">Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let problem of paginatedProblems" class="border-bottom">
                  <td class="fw-bold py-3">{{ problem.title }}</td>
                  <td class="py-3 text-secondary">{{ problem.description }}</td>
                  <td class="text-center py-3">
                    <span class="badge rounded-pill px-3 py-2" 
                      [ngClass]="{
                        'bg-success bg-opacity-75': problem.difficulty === 'Easy',
                        'bg-warning bg-opacity-75': problem.difficulty === 'Medium',
                        'bg-danger bg-opacity-75': problem.difficulty === 'Hard'
                      }">
                      <i class="fas" 
                        [ngClass]="{
                          'fa-smile me-1': problem.difficulty === 'Easy',
                          'fa-meh me-1': problem.difficulty === 'Medium',
                          'fa-frown me-1': problem.difficulty === 'Hard'
                        }"></i>
                      {{ problem.difficulty }}
                    </span>
                  </td>
                  <td class="py-3">
                    <div class="d-flex justify-content-center gap-2">
                      <button class="btn btn-sm btn-outline-primary rounded-pill px-3" (click)="viewProblem(problem.id)">
                        <i class="fas fa-eye me-1"></i> Voir
                      </button>
                      <button class="btn btn-sm btn-success rounded-pill px-3" (click)="launchProblem(problem.id)">
                        <i class="fas fa-play me-1"></i> Lancer
                      </button>
                      <button class="btn btn-sm btn-danger rounded-pill px-3" (click)="generatePDF(problem)">
                        <i class="fas fa-file-pdf me-1"></i> PDF
                      </button>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <!-- Improved no results message -->
          <div *ngIf="filteredProblems.length === 0" class="text-center my-5 py-4">
            <div class="empty-state">
              <i class="fas fa-search fa-3x text-muted mb-3"></i>
              <p class="text-muted">Aucun problème ne correspond aux filtres sélectionnés.</p>
              <button class="btn btn-outline-primary rounded-pill mt-2" (click)="resetFilters()">
                <i class="fas fa-sync me-1"></i> Réinitialiser les filtres
              </button>
            </div>
          </div>
          
          <!-- Improved pagination -->
          <div class="d-flex flex-column flex-md-row justify-content-between align-items-center mt-4" *ngIf="filteredProblems.length > 0">
            <div class="mb-3 mb-md-0">
              <span class="text-secondary fst-italic">
                Affichage {{ (currentPage - 1) * pageSize + 1 }} à 
                {{ Math.min(currentPage * pageSize, filteredProblems.length) }}
                sur {{ filteredProblems.length }} problèmes
              </span>
            </div>
            <nav aria-label="Problem pagination">
              <ul class="pagination pagination-sm mb-0">
                <li class="page-item" [class.disabled]="currentPage === 1">
                  <a class="page-link rounded-start" (click)="changePage(1)" aria-label="First">
                    <span aria-hidden="true">&laquo;</span>
                  </a>
                </li>
                <li class="page-item" [class.disabled]="currentPage === 1">
                  <a class="page-link" (click)="changePage(currentPage - 1)" aria-label="Previous">
                    <span aria-hidden="true">&lt;</span>
                  </a>
                </li>
                <li class="page-item" *ngFor="let page of getPaginationRange(); let i = index" 
                    [class.active]="currentPage === page">
                  <a class="page-link" (click)="changePage(page)">{{ page }}</a>
                </li>
                <li class="page-item" [class.disabled]="currentPage === totalPages">
                  <a class="page-link" (click)="changePage(currentPage + 1)" aria-label="Next">
                    <span aria-hidden="true">&gt;</span>
                  </a>
                </li>
                <li class="page-item" [class.disabled]="currentPage === totalPages">
                  <a class="page-link rounded-end" (click)="changePage(totalPages)" aria-label="Last">
                    <span aria-hidden="true">&raquo;</span>
                  </a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>