<div class="admin-blog-container">
  <div class="admin-blog-header">
    <h2>Liste des Blogs</h2>
    <button class="btn btn-primary" (click)="navigateToAddBlog()">
      <i class="fas fa-plus-circle"></i> Ajouter un blog
    </button>
  </div>

  <!-- Controls section -->
  <div class="admin-blog-controls">
    <div class="search-box">
      <input type="text" class="form-control" placeholder="Rechercher un blog..." [(ngModel)]="searchTerm"
        (input)="onSearch()">
      <button class="btn btn-outline-primary" (click)="onSearch()">
        <i class="fas fa-search"></i>
      </button>
    </div>

    <div class="filter-box">
      <label>Catégorie:</label>
      <select class="form-control" [(ngModel)]="selectedCategory" (change)="onSearch()">
        <option value="">Toutes les catégories</option>
        <option *ngFor="let category of getUniqueCategories()" [value]="category">
          {{ category }}
        </option>
      </select>
    </div>
  </div>

  <!-- Status messages -->
  <div *ngIf="isLoading" class="text-center my-5">
    <div class="spinner-border text-primary" role="status">
      <span class="visually-hidden">Chargement...</span>
    </div>
    <p class="mt-2">Chargement des blogs...</p>
  </div>

  <div *ngIf="errorMessage && !isLoading" class="alert alert-danger">
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && filteredBlogs.length === 0 && !errorMessage" class="alert alert-info">
    Aucun blog trouvé avec les critères sélectionnés.
  </div>

  <!-- Blogs list -->
  <div *ngIf="!isLoading && filteredBlogs.length > 0" class="blogs-table-container mt-4">
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th (click)="onSortChange('title')" class="sortable-header">
            Titre
            <i *ngIf="sortField === 'title'" class="fas"
              [ngClass]="sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"></i>
          </th>
          <th>Catégorie</th>
          <th (click)="onSortChange('date')" class="sortable-header">
            Date
            <i *ngIf="sortField === 'date'" class="fas"
              [ngClass]="sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"></i>
          </th>
          <th (click)="onSortChange('views')" class="sortable-header">
            Vues
            <i *ngIf="sortField === 'views'" class="fas"
              [ngClass]="sortDirection === 'asc' ? 'fa-sort-up' : 'fa-sort-down'"></i>
          </th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let blog of paginatedBlogs">
          <td class="blog-title-cell">{{ blog.title }}</td>
          <td>{{ blog.category }}</td>
          <td>{{ blog.createdAt | date:'dd/MM/yyyy' }}</td>
          <td>{{ blog.viewCount }}</td>
          <td class="blog-actions-cell">
            <button class="btn btn-sm btn-info me-1" (click)="viewBlog(blog.id)" title="Voir">
              <i class="fas fa-eye"></i>
            </button>
            <button class="btn btn-sm btn-warning me-1" (click)="editBlog(blog.id)" title="Modifier">
              <i class="fas fa-edit"></i>
            </button>
            <button class="btn btn-sm btn-danger" (click)="deleteBlog(blog.id)" title="Supprimer">
              <i class="fas fa-trash-alt"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="pagination-controls">
      <button class="btn btn-outline-primary" (click)="previousPage()" [disabled]="currentPage === 1">Précédent</button>
      <span>Page {{ currentPage }} sur {{ totalPages }}</span>
      <button class="btn btn-outline-primary" (click)="nextPage()" [disabled]="currentPage === totalPages">Suivant</button>
    </div>
  </div>
</div>